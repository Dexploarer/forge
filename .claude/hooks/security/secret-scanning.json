{
  "name": "secret-scanning",
  "event": "user-prompt-submit",
  "description": "Scans for accidentally committed secrets and API keys",
  "enabled": true,
  "prompt": "Before git commit, scan for secrets:\n\n**Patterns to Detect:**\n- API keys (AWS, GCP, Azure, Stripe, etc.)\n- JWT tokens\n- Private keys\n- Passwords in code\n- OAuth tokens\n- Database connection strings\n\n```\nüîê SECRET SCAN RESULTS\n\n‚õî SECRETS DETECTED!\n\nFile: [path]\nLine: [number]\nType: [AWS_ACCESS_KEY/API_KEY/PASSWORD]\nPattern: [AKIA...] (partially redacted)\n\nüö® COMMIT BLOCKED\n\nThis appears to be a real secret!\n\nImmediate actions:\n1. Remove secret from code\n2. Add to environment variables\n3. Rotate the exposed credential\n4. Add pattern to .gitignore\n5. Use secrets management (AWS Secrets Manager, etc.)\n\nIf already committed:\n1. Use git-filter-repo to remove\n2. Force push to rewrite history\n3. Rotate ALL exposed credentials\n4. Audit access logs\n\nSecret management best practices:\n‚Ä¢ Use environment variables\n‚Ä¢ Use .env files (not committed)\n‚Ä¢ Use cloud secrets managers\n‚Ä¢ Never hardcode credentials\n‚Ä¢ Rotate secrets regularly\n\nFalse positive? (yes/no)\n```"
}
