{
  "name": "env-file-protection",
  "event": "user-prompt-submit",
  "description": "Prevents committing sensitive .env files and credentials",
  "enabled": true,
  "prompt": "Before executing git add or git commit commands, scan for sensitive files:\n\n**Sensitive File Patterns to Detect:**\n- `.env`\n- `.env.local`, `.env.production`\n- `config/credentials.yml`\n- `*.pem`, `*.key`, `*.p12`\n- `secrets.json`, `credentials.json`\n- `id_rsa`, `id_ed25519`\n- `.aws/credentials`\n- `serviceAccount.json`\n\n**If Sensitive File Detected:**\n\n```\nðŸ” SENSITIVE FILE DETECTED\n\nAbout to commit: [filename]\nRisk: HIGH - Contains secrets/credentials\n\nâ›” This commit is BLOCKED\n\nWhy this matters:\nâ€¢ Secrets will be in git history forever\nâ€¢ Public repos expose credentials immediately\nâ€¢ Private repos still pose security risk\nâ€¢ Hard to fully remove from git history\n\nRecommended actions:\n\n1. Remove from staging:\n   git reset [filename]\n\n2. Add to .gitignore:\n   echo \"[filename]\" >> .gitignore\n   git add .gitignore\n\n3. Use environment variables instead:\n   - Use .env.example as template\n   - Document required vars in README\n   - Use secrets management (AWS Secrets Manager, etc.)\n\n4. If already committed:\n   - Use git-filter-repo to remove from history\n   - Rotate all exposed credentials\n   - Force push to update remote (carefully)\n\n5. Alternative for config:\n   - Use environment-specific configs\n   - Use cloud secret management\n   - Use encrypted secrets (git-crypt, SOPS)\n\nTo proceed anyway (NOT RECOMMENDED):\nâ€¢ Disable this hook temporarily\nâ€¢ Ensure repo will remain private\nâ€¢ Document why exception is needed\n```\n\n**Always Allow:**\n- `.env.example` files\n- `.env.template` files\n- Documentation about environment variables"
}
